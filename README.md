# 💣 Load Testing with K6

This repository contains a load testing project using [K6](https://k6.io/) to simulate concurrent users and generate performance reports.

---

## 📁 Project Structure

```plaintext
loadTestK6/
├── config/
│   ├── k6.config.js          # Test execution settings (VUs, duration, etc.)
│   └── options.js            # Additional test configurations
├── data/
│   └── env.js                # Contains the base URL of the tested API
├── scripts/
│   └── generate-report.js    # Script to convert summary.json to report.html
├── tests/
│   └── load.test.js          # Main load test script
├── results/
│   ├── summary.json          # Raw test results (generated by K6)
│   └── report.html           # HTML report generated from summary.json
└── README.md                 # Project documentation
```

---

## 🚀 How to Run the Load Test

1. **Install K6**:
   Follow the [official installation instructions](https://k6.io/docs/getting-started/installation/).

2. **Set the API Base URL**:
   - In the file `data/env.js`, define the base URL of the API to be tested:
     ```javascript
     export const BASE_URL = 'https://your-api-url.com';
     ```

3. **Run the Test**:
   - In the terminal, use the command:
     ```bash
     k6 run --summary-export=results/summary.json tests/load.test.js
     ```
   - This command will simulate **500 concurrent users for 5 minutes** and save the results in `results/summary.json`.

---

## 📊 Generate the HTML Report

1. After running the test, generate the report with:
   ```bash
   node scripts/generate-report.js
   ```
2. The file `results/report.html` will be created and can be opened directly in the browser.

---

## ⚙️ Test Configuration

- **Main Configuration**:
  - In the file `config/k6.config.js`:
    ```javascript
    export const options = {
        vus: 500,
        duration: '5m',
        thresholds: {
          http_req_duration: ['p(95)<500'], // 95% of requests should respond in <500ms
        },
    };
    ```

- **API Base URL**:
  - Defined in the file `data/env.js`:
    ```javascript
    export const BASE_URL = 'https://your-api-url.com';
    ```

---

## 📋 Metrics Collected

### What does each metric mean?
| Metric                        | Description                                                                 |
|--------------------------------|---------------------------------------------------------------------------|
| **Total Requests**             | Total number of requests made during the test.                           |
| **Requests per Second (RPS)**  | Average rate of requests per second.                                     |
| **% Requests with Status 200** | Percentage of successful requests (status 200).                         |
| **Average Response Time**      | Average response time for all requests.                                 |
| **P90/P95**                    | Response time for 90% and 95% of the fastest requests.                  |
| **% Requests < 500ms**         | Percentage of requests with response time under 500ms.                  |

### Example of Real Metrics:
| Metric                        | Value         |
|--------------------------------|---------------|
| **Total Requests**             | 357,591       |
| **Requests per Second**        | ~1,190        |
| **% Requests with Status 200** | 100% ✅        |
| **Average Response Time**      | 414ms         |
| **P95**                        | 1.09s ❌       |
| **% Requests < 500ms**         | ~66.6% ❌      |

---

## 📝 Example Results

### Generated Report:
After running the test, the HTML report includes the following data:
![Example Report](./assets/report-example.png)

### Technical Details:
- **JSON File** (`results/summary.json`): Contains raw test data.
- **HTML Report** (`results/report.html`): Generated from the JSON for easy visualization.

---

## 🛠️ Prerequisites

- **Node.js**: Version 18 or higher.
- **K6**: CLI installed on the system.

Install dependencies for generating reports with:
```bash
npm install
```

---

## 🌟 Technical Requirements

### Example Test Script (`tests/load.test.js`):
```javascript
import http from 'k6/http';
import { check } from 'k6';
import { BASE_URL } from '../data/env.js';
import { options } from '../config/k6.config.js';

export { options };

export default function () {
  const res = http.get(`${BASE_URL}/endpoint`);
  check(res, {
    'status is 200': (r) => r.status === 200,
    'response time < 500ms': (r) => r.timings.duration < 500,
  });
}
```

---

## 📂 Reports

- Markdown Report: [`report-analysis.md`](./report-analysis.md)
- HTML Report: Automatically generated in `results/report.html`.

---

## 📜 License

This project is licensed under the MIT License.